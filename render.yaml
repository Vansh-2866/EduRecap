services:
  - name: edurecap-api
    type: web
    env: docker
    plan: free
    dockerfilePath: apps/api/Dockerfile
    dockerContext: apps/api
    autoDeploy: true
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
      - key: JWT_SECRET
        generateValue: true
      - key: DATABASE_URL
        value: postgresql://neondb_owner:npg_mQK60qwZGFib@ep-cool-block-ah3weig3-pooler.c-3.us-east-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require
      - key: LOCAL_STORAGE_DIR
        value: /tmp/storage
      - key: MOCK_AI
        value: "false"
      - key: MAX_UPLOAD_MB
        value: "50"
      - key: TRANSCRIBER_URL
        value: https://REPLACE_WITH_TRANSCRIBER_URL
      - key: SUMMARIZER_URL
        value: https://REPLACE_WITH_SUMMARIZER_URL
      - key: IMAGEGEN_URL
        value: https://REPLACE_WITH_IMAGEGEN_URL

  - name: transcriber
    type: web
    env: docker
    plan: free
    dockerfilePath: services/transcriber/Dockerfile
    dockerContext: services/transcriber
    autoDeploy: true
    envVars:
      - key: PORT
        value: 8000
    healthCheckPath: /docs

  - name: summarizer
    type: web
    env: docker
    plan: free
    dockerfilePath: services/summarizer/Dockerfile
    dockerContext: services/summarizer
    autoDeploy: true
    envVars:
      - key: PORT
        value: 8001
    healthCheckPath: /docs

  - name: imagegen
    type: web
    env: docker
    plan: free
    dockerfilePath: services/imagegen/Dockerfile
    dockerContext: services/imagegen
    autoDeploy: true
    envVars:
      - key: PORT
        value: 8002
    healthCheckPath: /docs
